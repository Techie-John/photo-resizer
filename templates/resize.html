<!-- templates/resize.html -->
{% extends "base.html" %}

{% block content %}
<a href="/" class="back-link">← Upload a different image</a>

<div class="info-card">
    <h3>Original Image Information</h3>
    <p><strong>Filename:</strong> {{ filename }}</p>
    <p><strong>Current size:</strong> {{ original_width }} × {{ original_height }} pixels</p>
</div>

<form action="/resize" method="post">
    <input type="hidden" name="filename" value="{{ filename }}">
    
    <div class="dimensions">
        <div class="form-group">
            <label for="width">New Width (px):</label>
            <input type="number" name="width" id="width" min="1" max="10000" 
                   value="{{ original_width }}" required>
        </div>
        
        <div class="form-group">
            <label for="height">New Height (px):</label>
            <input type="number" name="height" id="height" min="1" max="10000" 
                   value="{{ original_height }}" required>
        </div>
    </div>
    
    <div class="checkbox-group">
        <input type="checkbox" name="maintain_aspect" id="maintain_aspect" checked>
        <label for="maintain_aspect">Maintain aspect ratio (recommended)</label>
    </div>
    
    <div style="margin-top: 30px;">
        <button type="submit" class="btn">Resize & Download</button>
    </div>
</form>

<script>
    // Auto-calculate dimensions when maintaining aspect ratio
    const widthInput = document.getElementById('width');
    const heightInput = document.getElementById('height');
    const aspectCheckbox = document.getElementById('maintain_aspect');
    
    const originalWidth = {{ original_width }};
    const originalHeight = {{ original_height }};
    const aspectRatio = originalWidth / originalHeight;
    
    function updateDimensions(changedInput) {
        if (!aspectCheckbox.checked) return;
        
        if (changedInput === widthInput) {
            const newWidth = parseInt(widthInput.value);
            if (newWidth > 0) {
                heightInput.value = Math.round(newWidth / aspectRatio);
            }
        } else {
            const newHeight = parseInt(heightInput.value);
            if (newHeight > 0) {
                widthInput.value = Math.round(newHeight * aspectRatio);
            }
        }
    }
    
    widthInput.addEventListener('input', () => updateDimensions(widthInput));
    heightInput.addEventListener('input', () => updateDimensions(heightInput));
</script>
{% endblock %}